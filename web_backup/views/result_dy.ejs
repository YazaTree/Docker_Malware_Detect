<!DOCTYPE html>
<html>

<head>
    <title>Docker Detect</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="result_style.css">
    <script type="text/javascript" src="http://code.jquery.com/jquery-3.5.1.min.js"></script> 
</head>

<body>
    <!-- ip 바꾸기 -->
  <a href="http://15.164.230.46:9099">돌아가기</a>
    <!-- 요약본 -->
    <div class="top_box">
        <div class="summary">
            <div id="img_name">
              <p><%= result.docker_img %></p>
            </div>
            <div id="date">
              <p>검사일: <%= result.finish_time %></p>
            </div>
            <div id="down">
                <a href="" title="Button push lightblue" class="button btnPush btnLightBlue" id="result1">결과 보고서</a>
                <a href="" title="Button push lightblue" class="button btnPush btnLightBlue" id="result2">조치 가이드</a>
            </div>
        </div>
        <!-- <span class="tags tag">
            </span> -->
    </div>

    <div class="bottom_box">
        <div id="menu">
          <span><a href="./result_st?img_name=<%= result.docker_img%>" id="static_index">Static analysis</a></span>
          <span><a href="./result_dy?img_name=<%= result.docker_img%>" id="dynamic_index">Dynamic analysis</a></span>
        </div>
        <div class="detail">
          <% for (const key in result) { %>
              <% if (result.hasOwnProperty(key)) { %>
                  <% if (typeof result[key] === 'object' && Object.keys(result[key]).length > 0) { %>
                      <p><%= key %>:</p>
                      <% for (const field in result[key]) { %>
                          <% if (result[key].hasOwnProperty(field)) { %>
                              <p>- <%= field %>: <%= result[key][field] %></p>
                          <% } %>
                      <% } %>
                  <% } else { %>
                      <p><%= key %>: <%= result[key] %></p>
                  <% } %>
              <% } %>
          <% } %>
      </div>
    </div>
    <!-- 팀원 소개 -->
    <div class="about">
        <div id="member">
            <p id="ff">About us</p>
            <p>Dynamic analysis : young-da <span>|</span> Static analysis : seomj</p>
            <p>Vulnerability analysis : lyk0331 <span>|</span> Sandbox : jagym105 </p>
            <p>Web : haehae00, SHNam00</p>
        </div>
    </div>
    <script>
        function updateWebPage(result) {
          const imageNameElement = document.getElementById('image-name');
          imageNameElement.textContent = result.docker_img;
        }
      
        function fetchDataAndRender() {
          fetch('/fetch-data') // 데이터를 가져올 엔드포인트 설정
            .then(response => response.json())
            .then(data => {
              // 데이터를 사용하여 웹 페이지 업데이트 로직 작성
              updateWebPage(data);
            })
            .catch(error => {
              console.error(error);
              // 에러 처리
            });
        }
      
        window.onload = function() {
          fetchDataAndRender(); // 초기 데이터 가져오기
          setInterval(fetchDataAndRender, 5000); // 5초마다 데이터 업데이트
        };
      </script>
    <!-- <script src="client.js"></script> -->
</body>

</html>
<script src="./result.js"></script>